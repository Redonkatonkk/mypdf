version: '3.8'

services:
  mypdf:
    image: redonkatonk/mypdf:latest
    user: "0:0"  # 以 root 用户运行，确保有读写权限
    container_name: mypdf
    ports:
      - "7777:7777" # Web 访问端口
      - "7778:7778" # API 服务端口
    volumes:
      # 使用 bind mount 确保目录自动创建
      - ./uploads:/app/backend/uploads
    environment:
      - TZ=Asia/Shanghai
    restart: unless-stopped
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:7778/health" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
